name: Manual test

on:
  workflow_dispatch:
    inputs:
      ENVIRONMENT: 
        type: choice
        description: On which environment should I run checks?
        options:
        - DEV
        - DEMO
        - QA
      GROUPS:
        description: 'Choose test groups to run from [admin, employee, retro]. Single group example: group1. Multiple groups separated with comma: group1,group2. By default all groups are selected.'
        default: ''
      EXCLUDE_GROUPS:
        description: 'Choose test groups to exclude from run. Single group example: group1. Multiple groups separated with comma: group1,group2.'
        default: 'retro,templates'
      WHERE_TO_RUN:
        description: Choose where to run?
        type: choice
        options:
        - web
        - mobile
        
env:
  WHERE_TO_RUN: ${{ inputs.WHERE_TO_RUN }}
  AWS_SECRET_DEV: "secret"
  AWS_SECRET_QA: "now way"

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: SonarQube scan
        uses: ./.github/actions/test
        with:
          CURRENT_BRANCH: ${GITHUB_REF#refs/heads/}
          PLACE: "branch=${GITHUB_REF#refs/heads/}"
          ENV: ${{ inputs.ENVIRONMENT}}
          AWS_TESTDATA_SECRET_NAME: $AWS_SECRET_${{ inputs.ENVIRONMENT }}
          WHERE_TO_RUN: ${{ inputs.WERE_TO_RUN }}

